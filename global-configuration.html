<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Global Configuration &#8212; FoundationDB 7.4.4 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-sphinx.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorials" href="tutorials.html" />
    <link rel="prev" title="Special Keys" href="special-keys.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          FoundationDB</a>
        <span class="navbar-text navbar-version pull-left"><b>7.4.4</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="contents.html">Site Map</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Global Configuration</a><ul>
<li><a class="reference internal" href="#reading-data">Reading data</a></li>
<li><a class="reference internal" href="#writing-data">Writing data</a><ul>
<li><a class="reference internal" href="#clearing-data">Clearing data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#watching-data">Watching data</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="special-keys.html" title="Previous Chapter: Special Keys"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Special Keys</span>
    </a>
  </li>
  <li>
    <a href="tutorials.html" title="Next Chapter: Tutorials"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Tutorials &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Global Configuration</a><ul>
<li><a class="reference internal" href="#reading-data">Reading data</a></li>
<li><a class="reference internal" href="#writing-data">Writing data</a><ul>
<li><a class="reference internal" href="#clearing-data">Clearing data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#watching-data">Watching data</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <section id="id1">
<h1>Global Configuration</h1>
<p>The global configuration framework is an eventually consistent configuration
mechanism to efficiently make runtime changes to all clients and servers. It
works by broadcasting updates made to the global configuration key space,
relying on individual machines to store existing configuration in-memory.</p>
<p>The global configuration framework provides a key-value interface to all
processes and clients in a FoundationDB cluster.</p>
<p>The global configuration framework is internal to FoundationDB and clients will
usually have no need to interact with it. The API is provided here for
reference.</p>
<section id="reading-data">
<h2>Reading data</h2>
<p>The global configuration framework is exposed through the
<code class="docutils literal notranslate"><span class="pre">GlobalConfig::globalConfig()</span></code> static function. There are separate ways to
read a value, depending on if it is an object or a primitive.</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0E3getK1T6KeyRef1T">
<span id="_CPPv3I0E3get6KeyRef1T"></span><span id="_CPPv2I0E3get6KeyRef1T"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E3getK1T6KeyRef1T" title="get::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">KeyRef</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">name</span></span>, <a class="reference internal" href="#_CPPv4I0E3getK1T6KeyRef1T" title="get::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">defaultVal</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Returns the value associated with <code class="docutils literal notranslate"><span class="pre">name</span></code> stored in global configuration,
or <code class="docutils literal notranslate"><span class="pre">defaultVal</span></code> if no key matching <code class="docutils literal notranslate"><span class="pre">name</span></code> exists. This templated
function is enabled only when the <code class="docutils literal notranslate"><span class="pre">std::is_arithmetic&lt;T&gt;</span></code> specialization
returns true.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GlobalConfig</span><span class="o">::</span><span class="n">globalConfig</span><span class="p">();</span>
<span class="kt">double</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">get</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;path/to/key&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv43get6KeyRef">
<span id="_CPPv33get6KeyRef"></span><span id="_CPPv23get6KeyRef"></span><span id="get__KeyRef"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Reference</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv411ConfigValue" title="ConfigValue"><span class="n"><span class="pre">ConfigValue</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">KeyRef</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">name</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Returns the value associated with <code class="docutils literal notranslate"><span class="pre">name</span></code> stored in global configuration.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GlobalConfig</span><span class="o">::</span><span class="n">globalConfig</span><span class="p">();</span>
<span class="k">auto</span><span class="w"> </span><span class="n">configValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;path/to/key&quot;</span><span class="p">);</span>

<span class="c1">// Check if value exists</span>
<span class="n">ASSERT</span><span class="p">(</span><span class="n">configValue</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">has_value</span><span class="p">());</span>
<span class="c1">// Cast to correct type</span>
<span class="k">auto</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">any_cast</span><span class="o">&lt;</span><span class="n">StringRef</span><span class="o">&gt;</span><span class="p">(</span><span class="n">configValue</span><span class="p">.</span><span class="n">value</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv43get11KeyRangeRef">
<span id="_CPPv33get11KeyRangeRef"></span><span id="_CPPv23get11KeyRangeRef"></span><span id="get__KeyRangeRef"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">KeyRef</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">Reference</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv411ConfigValue" title="ConfigValue"><span class="n"><span class="pre">ConfigValue</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">KeyRangeRef</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">range</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Returns all values in the specified range.</p>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv411ConfigValue">
<span id="_CPPv311ConfigValue"></span><span id="_CPPv211ConfigValue"></span><span id="ConfigValue"></span><span class="k"><span class="pre">type</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ConfigValue</span></span></span><br /></dt>
<dd><p>Holds a global configuration value and the arena where it lives.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">ConfigValue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">ReferenceCounted</span><span class="o">&lt;</span><span class="n">ConfigValue</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="n">Arena</span><span class="w"> </span><span class="n">arena</span><span class="p">;</span>
<span class="w">   </span><span class="n">std</span><span class="o">::</span><span class="n">any</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">arena</span></code></dt><dd><p>The arena where the value (and the associated key) lives in memory.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">value</span></code></dt><dd><p>The stored value.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="writing-data">
<h2>Writing data</h2>
<p>Writing data to global configuration is done using transactions written to the
special key space range <code class="docutils literal notranslate"><span class="pre">\xff\xff/global_config/</span> <span class="pre">-</span> <span class="pre">\xff\xff/global_config/0</span></code>.
Values must always be encoded according to the <a class="reference internal" href="api-python.html#api-python-tuple-layer"><span class="std std-ref">Tuple layer</span></a>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// In GlobalConfig.actor.h</span>
<span class="k">extern</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">KeyRef</span><span class="w"> </span><span class="n">myGlobalConfigKey</span><span class="p">;</span>
<span class="c1">// In GlobalConfig.actor.cpp</span>
<span class="k">const</span><span class="w"> </span><span class="n">KeyRef</span><span class="w"> </span><span class="n">myGlobalConfigKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;config/key&quot;</span><span class="n">_sr</span><span class="p">;</span>

<span class="c1">// When you want to set the value..</span>
<span class="n">Tuple</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Tuple</span><span class="o">::</span><span class="n">makeTuple</span><span class="p">((</span><span class="kt">double</span><span class="p">)</span><span class="mf">1.5</span><span class="p">);</span>

<span class="n">FDBTransaction</span><span class="o">*</span><span class="w"> </span><span class="n">tr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span>
<span class="n">tr</span><span class="o">-&gt;</span><span class="n">setOption</span><span class="p">(</span><span class="n">FDBTransactionOptions</span><span class="o">::</span><span class="n">SPECIAL_KEY_SPACE_ENABLE_WRITES</span><span class="p">);</span>
<span class="n">tr</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="n">GlobalConfig</span><span class="o">::</span><span class="n">prefixedKey</span><span class="p">(</span><span class="n">myGlobalConfigKey</span><span class="p">),</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="n">pack</span><span class="p">());</span>
<span class="c1">// commit transaction</span>
</pre></div>
</div>
<p>The client is responsible for avoiding conflicts with other global
configuration keys. For most uses, it is recommended to create a new key space.
For example, an application that wants to write configuration data should use
the <code class="docutils literal notranslate"><span class="pre">global_config/config/</span></code> namespace, instead of storing keys in the top
level <code class="docutils literal notranslate"><span class="pre">global_config/</span></code> key space.</p>
<section id="clearing-data">
<h3>Clearing data</h3>
<p>Data can be removed from global configuration using standard transaction
semantics. Submit a clear or clear range to the appropriate global
configuration keys in the special key space to clear data.</p>
</section>
</section>
<section id="watching-data">
<h2>Watching data</h2>
<p>Global configuration provides functionality to watch for changes.</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413onInitializedv">
<span id="_CPPv313onInitializedv"></span><span id="_CPPv213onInitializedv"></span><span id="onInitialized"></span><span class="n"><span class="pre">Future</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Void</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">onInitialized</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><br /></dt>
<dd><p>Returns a <code class="docutils literal notranslate"><span class="pre">Future</span></code> which will be triggered when global configuration has
been successfully initialized and populated with data.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv48onChangev">
<span id="_CPPv38onChangev"></span><span id="_CPPv28onChangev"></span><span id="onChange"></span><span class="n"><span class="pre">Future</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Void</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">onChange</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><br /></dt>
<dd><p>Returns a <code class="docutils literal notranslate"><span class="pre">Future</span></code> which will be triggered when any key-value pair in
global configuration changes.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv47trigger6KeyRefNSt8functionIFvNSt8optionalINSt3anyEEEEEE">
<span id="_CPPv37trigger6KeyRefNSt8functionIFvNSt8optionalINSt3anyEEEEEE"></span><span id="_CPPv27trigger6KeyRefNSt8functionIFvNSt8optionalINSt3anyEEEEEE"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">trigger</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">KeyRef</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">key</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">any</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">fn</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Registers a callback to be called when the value for global configuration
key <code class="docutils literal notranslate"><span class="pre">key</span></code> is changed. The callback function takes a single argument, an
optional which will be populated with the updated value when <code class="docutils literal notranslate"><span class="pre">key</span></code> is
changed, or an empty optional if the value was cleared. If the value is an
allocated object, its memory remains in control of global configuration.</p>
</dd></dl>

</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/global-configuration.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2013-2025 Apple, Inc and the FoundationDB project authors.<br/>
      Last updated on Aug 29, 2025.<br/>
    </p>
  </div>
</footer>
  </body>
</html>